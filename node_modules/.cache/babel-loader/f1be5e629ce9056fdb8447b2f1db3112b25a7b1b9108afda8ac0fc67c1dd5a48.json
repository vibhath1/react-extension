{"ast":null,"code":"import React,{useState,useRef,useEffect}from\"react\";import Message from\"./Message\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const BACKEND_URL=\"http://localhost:8000\";// change if needed\nconst ChatBox=()=>{const[messages,setMessages]=useState([]);const[userQuery,setUserQuery]=useState(\"\");const[loading,setLoading]=useState(false);const messagesEndRef=useRef(null);useEffect(()=>{var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:\"smooth\"});},[messages]);const sendMessage=async()=>{if(!userQuery.trim())return;const userMsg={role:\"user\",text:userQuery};setMessages(prev=>[...prev,userMsg]);setLoading(true);const res=await fetch(\"\".concat(BACKEND_URL,\"/query\"),{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({question:userQuery})});const data=await res.json();const aiMsg={role:\"ai\",text:data.answer,sources:data.sources||[]};setMessages(prev=>[...prev,aiMsg]);setUserQuery(\"\");setLoading(false);};const handleKeyDown=e=>{if(e.key===\"Enter\")sendMessage();};return/*#__PURE__*/_jsxs(\"div\",{className:\"chat-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chat-box\",children:[messages.map((msg,i)=>/*#__PURE__*/_jsx(Message,{msg:msg},i)),loading&&/*#__PURE__*/_jsx(\"div\",{className:\"msg ai\",children:\"\\u231B Generating response...\"}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-row\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Type your question...\",value:userQuery,onChange:e=>setUserQuery(e.target.value),onKeyDown:handleKeyDown}),/*#__PURE__*/_jsx(\"button\",{onClick:sendMessage,children:\"\\u27A4\"})]})]});};export default ChatBox;","map":{"version":3,"names":["React","useState","useRef","useEffect","Message","jsx","_jsx","jsxs","_jsxs","BACKEND_URL","ChatBox","messages","setMessages","userQuery","setUserQuery","loading","setLoading","messagesEndRef","_messagesEndRef$curre","current","scrollIntoView","behavior","sendMessage","trim","userMsg","role","text","prev","res","fetch","concat","method","headers","body","JSON","stringify","question","data","json","aiMsg","answer","sources","handleKeyDown","e","key","className","children","map","msg","i","ref","type","placeholder","value","onChange","target","onKeyDown","onClick"],"sources":["C:/Users/ASUS/Desktop/react-extension/src/components/ChatBox.jsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from \"react\";\r\nimport Message from \"./Message\";\r\n\r\nconst BACKEND_URL = \"http://localhost:8000\"; // change if needed\r\n\r\nconst ChatBox = () => {\r\n  const [messages, setMessages] = useState([]);\r\n  const [userQuery, setUserQuery] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n  const messagesEndRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\r\n  }, [messages]);\r\n\r\n  const sendMessage = async () => {\r\n    if (!userQuery.trim()) return;\r\n\r\n    const userMsg = { role: \"user\", text: userQuery };\r\n    setMessages((prev) => [...prev, userMsg]);\r\n    setLoading(true);\r\n\r\n    const res = await fetch(`${BACKEND_URL}/query`, {\r\n      method: \"POST\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify({ question: userQuery }),\r\n    });\r\n\r\n    const data = await res.json();\r\n    const aiMsg = {\r\n      role: \"ai\",\r\n      text: data.answer,\r\n      sources: data.sources || [],\r\n    };\r\n\r\n    setMessages((prev) => [...prev, aiMsg]);\r\n    setUserQuery(\"\");\r\n    setLoading(false);\r\n  };\r\n\r\n  const handleKeyDown = (e) => {\r\n    if (e.key === \"Enter\") sendMessage();\r\n  };\r\n\r\n  return (\r\n    <div className=\"chat-container\">\r\n      <div className=\"chat-box\">\r\n        {messages.map((msg, i) => (\r\n          <Message key={i} msg={msg} />\r\n        ))}\r\n        {loading && <div className=\"msg ai\">⌛ Generating response...</div>}\r\n        <div ref={messagesEndRef}></div>\r\n      </div>\r\n      <div className=\"input-row\">\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Type your question...\"\r\n          value={userQuery}\r\n          onChange={(e) => setUserQuery(e.target.value)}\r\n          onKeyDown={handleKeyDown}\r\n        />\r\n        <button onClick={sendMessage}>➤</button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ChatBox;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}